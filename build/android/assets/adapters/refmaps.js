const URL="http://refugeemaps.eu/_api/hotspots/hamburg.json";if(!Ti.App.Properties.hasProperty("MARKERS")){console.log("Info: first start=> we copy markers from Resources");var refmaps=require("adapters/refmaps.default").markers;Ti.App.Properties.setString("MARKERS",JSON.stringify(refmaps))}var GeoTools=require("vendor/georoute").createGeo();exports.sortByDistanceToOwnPosition=function(a,e){GeoTools.getLocation(function(n){a.forEach(function(a){a.distance=GeoTools.getDistBearing(n.latitude,n.longitude,a.position.lat,a.position.lng).distance,a.bearing=GeoTools.getDistBearing(n.latitude,n.longitude,a.position.lat,a.position.lng).bearing}),a.sort(function(a,e){return a.distance>e.distance?1:-1}),e(a)})},exports.getPOIs=function(a){function e(){a?a(JSON.parse(Ti.App.Properties.getString("MARKERS"))):n.OK&&n.OK(JSON.parse(Ti.App.Properties.getString("MARKERS")))}Ti.Network.online||(console.log("Warning: offline => we use old markers"),e());var n=Ti.Network.createHTTPClient({onload:function(){console.log("Info: online => we use fresh markers"),Ti.App.Properties.setString("MARKERS",this.responseText),e()},onerror:e});return n.open("GET",URL),n.send(),n};