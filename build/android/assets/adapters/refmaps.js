const URL="http://refugeemaps.eu/_api/hotspots/hamburg.json";if(!Ti.App.Properties.hasProperty("MARKERS")){console.log("Info: first start=> we copy markers from Resources");var refmaps=require("adapters/refmaps.default").markers;Ti.App.Properties.setString("MARKERS",JSON.stringify(refmaps))}var GeoTools=require("vendor/georoute").createGeo();exports.sortByDistanceToOwnPosition=function(a,e,n){GeoTools.getLocation(function(t){a.forEach(function(a){a.distance=GeoTools.getDistBearing(t.latitude,t.longitude,a.position.lat,a.position.lng).distance,a.bearing=GeoTools.getDistBearing(t.latitude,t.longitude,a.position.lat,a.position.lng).bearing}),a.sort(function(a,e){return a.distance>e.distance?1:-1}),e(a),GeoTools.getAddress(t,n)})},exports.getPOIs=function(a){function e(){var e=JSON.parse(Ti.App.Properties.getString("MARKERS")),t=Ti.App.Properties.getObject("MARKERCATEGORIES",{}),r={};e.forEach(function(a){console.log(a.category),r[a.category]=void 0==t[a.category]?!0:t[a.category]}),console.log(r),Ti.App.Properties.setObject("MARKERCATEGORIES",r);var g={markers:e,categories:r};a?a(g):n.OK&&n.OK(g)}Ti.Network.online||(console.log("Warning: offline => we use old markers"),e());var n=Ti.Network.createHTTPClient({onload:function(){console.log("Info: online => we use fresh markers"),Ti.App.Properties.setString("MARKERS",this.responseText),e()},onerror:e});return n.open("GET",URL),n.send(),n};