void 0===Number.prototype.toDegrees&&(Number.prototype.toDegrees=function(){return 180*this/Math.PI}),void 0===Number.prototype.toRadians&&(Number.prototype.toRadians=function(){return this*Math.PI/180});var Module=function(){return this.eventhandlers=[],this};Module.prototype={compassPoint:function(e,a){void 0===a&&(a=3),e=(e%360+360)%360;var t;switch(a){case 1:switch(Math.round(4*e/360)%4){case 0:t="N";break;case 1:t="E";break;case 2:t="S";break;case 3:t="W"}break;case 2:switch(Math.round(8*e/360)%8){case 0:t="N";break;case 1:t="NE";break;case 2:t="E";break;case 3:t="SE";break;case 4:t="S";break;case 5:t="SW";break;case 6:t="W";break;case 7:t="NW"}break;case 3:switch(Math.round(16*e/360)%16){case 0:t="N";break;case 1:t="NNE";break;case 2:t="NE";break;case 3:t="ENE";break;case 4:t="E";break;case 5:t="ESE";break;case 6:t="SE";break;case 7:t="SSE";break;case 8:t="S";break;case 9:t="SSW";break;case 10:t="SW";break;case 11:t="WSW";break;case 12:t="W";break;case 13:t="WNW";break;case 14:t="NW";break;case 15:t="NNW"}break;default:throw console.log("Precision must be between 1 and 3")}return t},getDistBearing:function(e,a,t,n){const r=(Math.PI,6371e3);var e=e.toRadians(),t=t.toRadians(),i=(t-e).toRadians(),s=(n-a).toRadians(),l=Math.sin(i/2)*Math.sin(i/2)+Math.cos(e)*Math.cos(t)*Math.sin(s/2)*Math.sin(s/2),g=Math.sin(n-a)*Math.cos(t),o=Math.cos(e)*Math.sin(t)-Math.sin(e)*Math.cos(t)*Math.cos(n-a);return{bearing:Math.atan2(g,o).toDegrees(),distance:2*r*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))}},getLocation:function(e){var a=arguments[0]||{};Ti.Geolocation.locationServicesEnabled?(Ti.Geolocation.purpose=a.purpose||"Deine Position für Routingberechnung",Ti.Geolocation.getCurrentPosition(function(a){return a.error?(Ti.API.error("Error: "+a.error),console.log(a.error),Ti.App.Properties.removeProperty("lastGeolocation"),void 0):(Ti.App.Properties.setString("lastGeolocation",JSON.stringify(a.coords)),Ti.Media.vibrate([1]),e&&e(a.coords),void console.log("Position found"+JSON.stringify(a.coords)))})):Ti.UI.createAlertDialog({message:"Um alle Geofunktionen nutzen zu können, muss der Standortdienst eingeschaltet sein.",title:"Standortdienst gestört …"}).show()},getLatLng:function(e){var a=this,t="https://maps.googleapis.com/maps/api/geocode/json?&sensor=true&address="+encodeURIComponent(e);xhr=Ti.Network.createHTTPClient(),xhr.onload=function(){var e=JSON.parse(this.responseText);"OK"==e.status&&a.fireEvent("latlng",e.results[0].geometry.location)},xhr.open("GET",t),xhr.send()},getAddress:function(e,a){var t="https://maps.googleapis.com/maps/api/geocode/json?&sensor=true&latlng="+e.latitude+","+e.longitude;xhr=Ti.Network.createHTTPClient(),xhr.onload=function(){var e=JSON.parse(this.responseText),t={};e.results[0].address_components.forEach(function(e){"street_number"==e.types[0]&&(t.street_number=e.long_name),"route"==e.types[0]&&(t.street=e.long_name)}),a&&a(t)},xhr.open("GET",t),xhr.send()},getRoute:function(e,a,t){var n="https://maps.googleapis.com/maps/api/directions/json?language="+Ti.Locale.getCurrentLanguage()+"&mode="+Ti.App.Properties.getString("MODE","walking")+"&origin="+e.latitude+","+e.longitude+"&destination="+a.latitude+","+a.longitude+"&sensor=false";console.log(n),xhr=Ti.Network.createHTTPClient(),xhr.error=function(){console.log(this.error)},xhr.onload=function(){var e=JSON.parse(this.responseText);t&&"function"==typeof t&&"OK"==e.status&&t(e.routes[0])},xhr.open("GET",n),xhr.send()},fireEvent:function(e,a){if(this.eventhandlers[e])for(var t=0;t<this.eventhandlers[e].length;t++)this.eventhandlers[e][t].call(this,a)},addEventListener:function(e,a){this.eventhandlers[e]||(this.eventhandlers[e]=[]),this.eventhandlers[e].push(a)},removeEventListener:function(e,a){if(this.eventhandlers[e]){var t=this.eventhandlers[e].filter(function(e){return e!=a});this.eventhandlers[e]=t}}},exports.createGeo=function(){return new Module};